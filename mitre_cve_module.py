from mitrecve import crawler
import pandas as pd

def mitre_cve_query(tech):

    cve_simple = crawler.get_main_page(tech)
    df = pd.DataFrame.from_dict(cve_simple).T

    if len(df) != 0:

        condition = ['2023', '2024']

        filtered_df = df[df['ID'].str.contains('|'.join(condition), case=False, na=False)]

    else:

        error = "error"

    return filtered_df