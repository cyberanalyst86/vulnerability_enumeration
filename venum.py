import pandas as pd
from nist_nvd_module import *
from exploitdb_module import *
from mitre_cve_module import *

def main():

    df_nistnvd_list = []
    df_exploitdb_list = []

    technology_input = input("Enter excel file path: ")

    df = pd.read_excel(technology_input)

    technology_list = df["technology"].tolist()

    for tech in technology_list:

        print(tech)

        #--------------Query NIST NVD------------
        print("Query NIST NVD......")
        df_nistnvd = nist_nvd_query(tech)

        df_nistnvd_list.append(df_nistnvd)

        #--------------Query ExploitDB------------
        print("Query Exploitdb......")
        df_exploitdb = exploitdb_query(tech)

        df_exploitdb_list.append(df_exploitdb)

    df_nistnvd_concat = pd.concat(df_nistnvd_list)
    df_exploitdb_concat = pd.concat(df_exploitdb_list)

    df_nistnvd_concat.to_excel("nist_nvd.xlsx", index=False)
    df_exploitdb_concat.to_excel("exploitdb.xlsx", index=False)

    print("enumeration completed")

if __name__ == "__main__":
        main()